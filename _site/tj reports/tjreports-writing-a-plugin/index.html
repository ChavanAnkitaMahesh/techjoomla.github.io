<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="generator" content="Jekyll v3.4.3">

		<link rel="stylesheet" href="/css/screen.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">
		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400italic,400,300italic,300,700,700italic|Open+Sans:400italic,600italic,700italic,700,600,400|Inconsolata:400,700">
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

		<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>Writing a report plugin - Techjoomla</title>
<meta property="og:title" content="Writing a report plugin" />
<meta name="description" content="Example Report Plugin The plugin type for TJ Reports plugins is tjreports." />
<meta property="og:description" content="Example Report Plugin The plugin type for TJ Reports plugins is tjreports." />
<link rel="canonical" href="http://localhost:4000/tj%20reports/tjreports-writing-a-plugin/" />
<meta property="og:url" content="http://localhost:4000/tj%20reports/tjreports-writing-a-plugin/" />
<meta property="og:site_name" content="Techjoomla" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-15T00:00:00+05:30" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Writing a report plugin",
"datePublished": "2017-01-15T00:00:00+05:30",
"description": "Example Report Plugin The plugin type for TJ Reports plugins is tjreports.",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "http://localhost:4000/techjoomla.png"}},
"url": "http://localhost:4000/tj%20reports/tjreports-writing-a-plugin/"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Techjoomla" />

		
	</head>

	<body class="">
		<header>
			<div class="wrapper">
				<section class="top-bar">
					<div class="logo"><a href="https://techjoomla.com" target="_blank"><img src="/images/techjoomla.png" alt="Techjoomla">
</a></div>
					<a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
<nav>
	<a class="editor-link btn" href="cloudcannon:collections/_data/navigation.yml" class="btn" style="padding: 5px;"><strong>&#9998;</strong> Edit navigation</a>
	
	

		
		<a href="/" class="">Docs Home</a>
	
	<a href="https://github.com/techjoomla" target="_blank">Github</a>
	<a href="https://techjoomla.com/" target="_blank">Our Website</a>
	
</nav>

				</section>
				<section class="hero_search">
					<h1>Documentation</h1>
					<p>Everything you need to know about using and extending Techjoomla products.</p>
					<form action="/search/" method="get">
	<input type="search" name="q"  placeholder="What would you like to know?" autofocus>
	<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
	<input type="submit" value="Search" style="display: none;">
</form>
				</section>
			</div>

		</header>
		<section class="content">
			<div class="wrapper">
				<section class="tutorial">
	
	<section class="sidebar sticky">
		<ul>
			
			
				<li><a href="#folder-structure">Folder structure</a></li>
			
				<li><a href="#manifest-file-examplereportxml">Manifest File (examplereport.xml)</a></li>
			
				<li><a href="#the-main-report-file-examplereportphp">The main report file (examplereport.php)</a></li>
			
		</ul>
	</section>
	
	<section class="tutorial-content">
		<!--<h1>Writing a report plugin</h1>-->

		
		
		<div class="tutorial-main">
			<h1 id="example-report-plugin">Example Report Plugin</h1>
<p>The plugin type for TJ Reports plugins is <code class="highlighter-rouge">tjreports</code>.</p>

<h2 id="folder-structure">Folder structure</h2>

<ul>
  <li>plugins/tjreports/examplereport/examplereport.xml</li>
  <li>plugins/tjreports/examplereport/examplereport.php</li>
  <li>plugins/tjreports/examplereport/language/en-GB/en-GB.plg_tjreports_examplereport.ini</li>
</ul>

<h2 id="manifest-file-examplereportxml">Manifest File (examplereport.xml)</h2>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;extension</span> <span class="na">version=</span><span class="s">"3.1"</span> <span class="na">type=</span><span class="s">"plugin"</span> <span class="na">group=</span><span class="s">"tjreports"</span> <span class="na">method=</span><span class="s">"upgrade"</span><span class="nt">&gt;</span>
<span class="nt">&lt;name&gt;</span>PLG_TJREPORTS_EXAMPLEREPORT<span class="nt">&lt;/name&gt;</span>
<span class="nt">&lt;author&gt;</span>Techjoomla<span class="nt">&lt;/author&gt;</span>
<span class="nt">&lt;creationDate&gt;</span>17th June 2016<span class="nt">&lt;/creationDate&gt;</span>
<span class="nt">&lt;copyright&gt;</span>(C)techjoomla.com<span class="nt">&lt;/copyright&gt;</span>
<span class="nt">&lt;license&gt;</span>http://www.gnu.org/copyleft/gpl.html GNU/GPL<span class="nt">&lt;/license&gt;</span>
<span class="nt">&lt;authorEmail&gt;</span>contact@techjoomla.com<span class="nt">&lt;/authorEmail&gt;</span>
<span class="nt">&lt;authorUrl&gt;</span>www.techjoomla.com<span class="nt">&lt;/authorUrl&gt;</span>
<span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;description&gt;</span>PLG_TJREPORTS_EXAMPLEREPORT_DESC<span class="nt">&lt;/description&gt;</span>
	<span class="nt">&lt;files&gt;</span>
		<span class="nt">&lt;filename</span> <span class="na">plugin=</span><span class="s">"examplereport"</span><span class="nt">&gt;</span>examplereport.php<span class="nt">&lt;/filename&gt;</span>
		<span class="nt">&lt;filename&gt;</span>index.html<span class="nt">&lt;/filename&gt;</span>
		<span class="nt">&lt;folder&gt;</span>language<span class="nt">&lt;/folder&gt;</span>
	<span class="nt">&lt;/files&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
</code></pre>
</div>

<h2 id="the-main-report-file-examplereportphp">The main report file (examplereport.php)</h2>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>  
<span class="c1">// No direct access  
</span><span class="nb">defined</span><span class="p">(</span><span class="s1">'_JEXEC'</span><span class="p">)</span> <span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s1">'Restricted access'</span><span class="p">);</span>

<span class="c1">//Include TJReport Model
</span><span class="nx">JLoader</span><span class="o">::</span><span class="na">import</span><span class="p">(</span><span class="s1">'com_tjreports.models.reports'</span><span class="p">,</span> <span class="nx">JPATH_SITE</span> <span class="o">.</span> <span class="s1">'/components'</span><span class="p">);</span>

<span class="sd">/**
 * Example report plugin of TJReport
 *
 * @since  1.0.0
 */</span>
<span class="k">class</span> <span class="nc">TjreportsModelExamplereport</span> <span class="k">extends</span> <span class="nx">TjreportsModelReports</span>
<span class="p">{</span>
	<span class="c1">// Default ordering column
</span>	<span class="k">protected</span> <span class="nv">$default_order</span> <span class="o">=</span> <span class="s1">'name'</span><span class="p">;</span>

	<span class="c1">// Default ordering direction
</span>	<span class="k">protected</span> <span class="nv">$default_order_dir</span> <span class="o">=</span> <span class="s1">'ASC'</span><span class="p">;</span>

	<span class="cm">/* Must have constructor that will define columns of the report */</span>
	<span class="sd">/**
	 * Constructor.
	 *
	 * @param   array  $config  An optional associative array of configuration settings.
	 *
	 * @see     JModelLegacy
	 * @since   1.6
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$config</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="sd">/**
		 * $this-&gt;columns is an associative array and one of the main entity of report plugin
		 * In this Array Key denotes the report header
		 * Value is also an associative array where -
		 * a)'table_column' - is directly linked to table column. This is also used in framework for ordering.
		 * If you have complex column like having COUNT than you should leave its value blank
		 * b) 'titleâ€™ - Title will be displayed on header and on hideshow checkbox
		 * c) 'disable_sorting' - Set to true of this column is not sortable by default all columns are sortable
		 */</span>
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">columns</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
			<span class="s1">'attempt'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'table_column'</span> <span class="o">=&gt;</span> <span class="s1">'lt.attempt'</span><span class="p">,</span> <span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'COM_TJLMS_TITLE_ATTEMPTS'</span><span class="p">),</span>
			<span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'table_column'</span> <span class="o">=&gt;</span> <span class="s1">'l.name'</span><span class="p">,</span> <span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'COM_TJLMS_ATTEMPTREPORT_NAME'</span><span class="p">),</span>
			<span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'table_column'</span> <span class="o">=&gt;</span> <span class="s1">'u.username'</span><span class="p">,</span> <span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'COM_TJLMS_REPORT_USERUSERNAME'</span><span class="p">),</span>
			<span class="s1">'usergroup'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">'COM_TJLMS_REPORT_USERGROUP'</span><span class="p">,</span> <span class="s1">'disable_sorting'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">),</span>
		<span class="p">);</span>

		<span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$config</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* Add your stylesheets here if you want any styling added to the page */</span>
	<span class="sd">/**
	 * Get style for left sidebar menu
	 *
	 * @return ARRAY Keys of data
	 *
	 * @since   2.0
	 * */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">getStyles</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="k">array</span><span class="p">(</span>
			<span class="nx">JUri</span><span class="o">::</span><span class="na">root</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'/css/tjlms_backend.css'</span>
		<span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* Add filters dropdown or textboxes to the header or on the top of the table */</span>
	<span class="sd">/**
	 * Create an array of filters
	 *
	 * @return    ARRAY Filters used in reports
	 *
	 * @since    1.0
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">displayFilters</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="sd">/**
		 * This method should return associative array and this can have max size of 2
		 * Header level filters will be defined in 0 index. eg. - attempt, name
		 * Top level filters will be defined in 1 index like if in single course report you want to select course and then itâ€™s report will be populated. eg. - last_accessed_on
		 * Each filter will be an associative aray which can have follwoing keys-
		 * a)search_type - it can be text, select, date.range, calendar, html
		 * for select type field you need to mention select_options which is an array of  JHTML::_('select.option')
		 * b) searchin -  if you want framework to add where clause for search criteria you can define type. This is the column name where you want to search.
		 * c) type - This can be 'equalâ€™,â€™customâ€™ otherwise by default it will match for like clause.
		 */</span>

		<span class="nv">$dispFilters</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
			<span class="k">array</span><span class="p">(</span>
				<span class="s1">'attempt'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
					<span class="s1">'search_type'</span> <span class="o">=&gt;</span> <span class="s1">'text'</span><span class="p">,</span> <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'equal'</span><span class="p">,</span> <span class="s1">'searchin'</span> <span class="o">=&gt;</span> <span class="s1">'lt.attempt'</span><span class="p">),</span>
				<span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
					<span class="s1">'search_type'</span> <span class="o">=&gt;</span> <span class="s1">'select'</span><span class="p">,</span> <span class="s1">'select_options'</span> <span class="o">=&gt;</span> <span class="nv">$lessonFilter</span><span class="p">,</span> <span class="s1">'type'</span> <span class="o">=&gt;</span> <span class="s1">'equal'</span><span class="p">,</span> <span class="s1">'searchin'</span> <span class="o">=&gt;</span> <span class="s1">'lt.lesson_id'</span>
				<span class="p">),</span>
			<span class="p">),</span>
			<span class="k">array</span><span class="p">(</span>
				<span class="s1">'last_accessed_on'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
					<span class="s1">'search_type'</span> <span class="o">=&gt;</span> <span class="s1">'date.range'</span><span class="p">,</span>
					<span class="s1">'searchin'</span> <span class="o">=&gt;</span> <span class="s1">'last_accessed_on'</span><span class="p">,</span>
					<span class="s1">'last_accessed_on_from'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'attrib'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'placeholder'</span> <span class="o">=&gt;</span> <span class="s1">'FROM (YYYY-MM-DD)'</span><span class="p">)),</span>
					<span class="s1">'last_accessed_on_to'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'attrib'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'placeholder'</span> <span class="o">=&gt;</span> <span class="s1">'TO (YYYY-MM-DD)'</span><span class="p">)),</span>
				<span class="p">)</span>
			<span class="p">)</span>
		<span class="p">);</span>

		<span class="k">return</span> <span class="nv">$dispFilters</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* Reports main query will be defined in this function */</span>
	<span class="sd">/**
	 * Method to get a JDatabaseQuery object for retrieving the data set from a database.
	 *
	 * @return  JDatabaseQuery  A JDatabaseQuery object to retrieve the data set.
	 *
	 * @since   1.6
	 */</span>
	<span class="k">protected</span> <span class="k">function</span> <span class="nf">getListQuery</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="nv">$db</span>        <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_db</span><span class="p">;</span>

		<span class="cm">/* Create query instance by calling parents getListQuery */</span>
		<span class="nv">$query</span>     <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getListQuery</span><span class="p">();</span>

		<span class="cm">/* You can get which columns are visible by calling below method */</span>
		<span class="nv">$colToshow</span> <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getState</span><span class="p">(</span><span class="s1">'colToshow'</span><span class="p">);</span>

		<span class="sd">/**
		 * Currently active filters and itâ€™s value are stored in filters and can get from below method.
		 * Also make sure you do not call getstate inside constructor and populatestate method
		 */</span>
		<span class="nv">$filters</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getState</span><span class="p">(</span><span class="s1">'filters'</span><span class="p">);</span>
		<span class="nv">$user</span>     <span class="o">=</span> <span class="nx">JFactory</span><span class="o">::</span><span class="na">getUser</span><span class="p">();</span>
		<span class="nv">$userId</span>   <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">;</span>

		<span class="cm">/*
		 * Must have columns to get details of non linked data like completion
		 * and not defined in title_column of $this-&gt;columns array
		 */</span>
		<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'user_id'</span><span class="p">));</span>
		<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'#__tjlms_lesson_track'</span><span class="p">,</span> <span class="s1">'lt'</span><span class="p">));</span>
		<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">'INNER'</span><span class="p">,</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'#__tjlms_lessons'</span><span class="p">,</span> <span class="s1">'l'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' ON ('</span> <span class="o">.</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'lt.lesson_id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' = '</span> <span class="o">.</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'l.id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">')'</span><span class="p">);</span>
		<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">'INNER'</span><span class="p">,</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'#__tjlms_courses'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' ON ('</span> <span class="o">.</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'c.id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' = '</span> <span class="o">.</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'l.course_id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">')'</span><span class="p">);</span>
		<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">'INNER'</span><span class="p">,</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'#__users'</span><span class="p">,</span> <span class="s1">'u'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' ON ('</span> <span class="o">.</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'lt.user_id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' = '</span> <span class="o">.</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'u.id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">')'</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="s1">'usergroup'</span><span class="p">,</span> <span class="nv">$colToshow</span><span class="p">))</span>
		<span class="p">{</span>
			<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">getQuery</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
			<span class="nv">$subQuery</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'ugm.group_id'</span><span class="p">);</span>
			<span class="nv">$subQuery</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'#__user_usergroup_map'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' as ugm'</span><span class="p">);</span>
			<span class="nv">$subQuery</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'ugm.user_id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' = '</span> <span class="o">.</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'lt.user_id'</span><span class="p">));</span>
			<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'(SELECT GROUP_CONCAT(ug.title SEPARATOR ", ") from  #__usergroups ug where ug.id IN('</span> <span class="o">.</span> <span class="nv">$subQuery</span> <span class="o">.</span> <span class="s1">')) as usergroup'</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$filters</span><span class="p">[</span><span class="s1">'usergroup'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$filters</span><span class="p">[</span><span class="s1">'usergroup'</span><span class="p">]))</span>
			<span class="p">{</span>
				<span class="nv">$subQuery</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">getQuery</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
				<span class="nv">$subQuery</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'ugm.user_id'</span><span class="p">);</span>
				<span class="nv">$subQuery</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'#__user_usergroup_map'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' as ugm'</span><span class="p">);</span>
				<span class="nv">$subQuery</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">quoteName</span><span class="p">(</span><span class="s1">'ugm.group_id'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">' = '</span> <span class="o">.</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$filters</span><span class="p">[</span><span class="s1">'usergroup'</span><span class="p">]);</span>
				<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'lt.user_id IN('</span> <span class="o">.</span> <span class="nv">$subQuery</span> <span class="o">.</span> <span class="s1">')'</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>


		<span class="k">return</span> <span class="nv">$query</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* If you want to perform any data manipulation before sending it to framework you can override below getItems method */</span>
	<span class="sd">/**
	 * Method to get an array of data items.
	 *
	 * @return  mixed  An array of data items on success, false on failure.
	 *
	 * @since   1.6
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">getItems</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="nv">$items</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getItems</span><span class="p">();</span>

		<span class="nv">$lmsparams</span> <span class="o">=</span> <span class="nx">JComponentHelper</span><span class="o">::</span><span class="na">getParams</span><span class="p">(</span><span class="s1">'com_tjlms'</span><span class="p">);</span>
		<span class="nv">$date_format_show</span> <span class="o">=</span> <span class="nv">$lmsparams</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'date_format_show'</span><span class="p">,</span> <span class="s1">'Y-m-d H:i:s'</span><span class="p">);</span>

		<span class="nx">jimport</span><span class="p">(</span><span class="s1">'techjoomla.common'</span><span class="p">);</span>
		<span class="nv">$tjCommon</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TechjoomlaCommon</span><span class="p">;</span>

		<span class="k">foreach</span> <span class="p">(</span><span class="nv">$items</span> <span class="k">as</span> <span class="nv">$item</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$item</span><span class="p">[</span><span class="s1">'last_accessed_on'</span><span class="p">])</span> <span class="o">||</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'last_accessed_on'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'0000-00-00 00:00:00'</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="nv">$item</span><span class="p">[</span><span class="s1">'last_accessed_on'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">' - '</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">else</span>
			<span class="p">{</span>
				<span class="nv">$item</span><span class="p">[</span><span class="s1">'last_accessed_on'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$tjCommon</span><span class="o">-&gt;</span><span class="na">getDateInLocal</span><span class="p">(</span><span class="nv">$item</span><span class="p">[</span><span class="s1">'last_accessed_on'</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$date_format_show</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="k">return</span> <span class="nv">$items</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

		</div>
		<div class="tutorial-share">
			<a class="modalOpen no-smooth" href="#subscribe">
			<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
		
 Subscribe</a>
			<a class="modalOpen no-smooth" href="#share">
			<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
				<path d="M0 0h24v24H0z" fill="none"/>
				<path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
			</svg>
		
 Share</a>
		</div>
	</section>
</section>





	<div class="related">
		<h3>Related tutorials</h3>

		<ul class="listing">
	
		<li >
			<a href="/joomla%20rest%20api/com-api-making-api-calls/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Making calls to API resources</h3>
						<p class="description"></p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/tc%20manager/tc-manager-overview/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Terms & Conditions Manager Overview</h3>
						<p class="description"></p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/tj%20reports/tjreports-integration-guide/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Integration Guide</h3>
						<p class="description"></p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/tj%20reports/tjreports-architecture-overview/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Architecture Overview</h3>
						<p class="description"></p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/joomla%20rest%20api/com-api-plugin-development/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Writing your own API Plugin</h3>
						<p class="description">API framework for Joomla</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/joomla%20rest%20api/com-api-introduction/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Introduction</h3>
						<p class="description">REST API framework for Joomla</p>
					</div>
				</article>
			</a>
		</li>
	
</ul>
	</div>




<div id="subscribe" class="modalDialog">
	<div>
		<a title="Close" class="close">&times;</a>
		<form action="" method="post">
			<h2>Subscribe</h2>
			<p>The latest tutorials sent straight to your inbox.</p>
			<input type="email" name="EMAIL" placeholder="Email">
			<input type="submit" value="Sign up">
		</form>
	</div>
</div>

<div id="share" class="modalDialog sharing">
	<div>
		<a title="Close" class="close">&times;</a>
		<h2>Share</h2>
		<p>Share this tutorial with your community.</p>
		<ul>
			<li><a class="twitter" target="_blank" href="https://twitter.com/intent/tweet?text=Writing a report plugin&via=techjoomla&url=http%3A%2F%2Flocalhost%3A4000%2Ftj%2520reports%2Ftjreports-writing-a-plugin%2F">
		<svg class="twitter" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	
 Twitter</a></li>
			<li><a class="facebook" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Ftj%2520reports%2Ftjreports-writing-a-plugin%2F">
		<svg class="facebook" xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="15.8 15.8 25 25"><path d="M32.8 24.7h-3.2v-2.1c0-0.8 0.5-1 0.9-1s2.3 0 2.3 0v-3.5l-3.1 0c-3.5 0-4.3 2.6-4.3 4.3v2.3h-2v3.6h2c0 4.6 0 10.2 0 10.2h4.2c0 0 0-5.6 0-10.2h2.8L32.8 24.7z"/></svg>
	
 Facebook</a></li>
			<li><a class="google-plus" target="_blank" href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2Ftj%2520reports%2Ftjreports-writing-a-plugin%2F">
		<svg class="google-plus" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M23,11H21V9H19V11H17V13H19V15H21V13H23M8,11V13.4H12C11.8,14.4 10.8,16.4 8,16.4C5.6,16.4 3.7,14.4 3.7,12C3.7,9.6 5.6,7.6 8,7.6C9.4,7.6 10.3,8.2 10.8,8.7L12.7,6.9C11.5,5.7 9.9,5 8,5C4.1,5 1,8.1 1,12C1,15.9 4.1,19 8,19C12,19 14.7,16.2 14.7,12.2C14.7,11.7 14.7,11.4 14.6,11H8Z" /></svg>
	
 Google+</a></li>
			<li><a class="linkedin" target="_blank" href="https://www.linkedin.com/shareArticle
?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Ftj%2520reports%2Ftjreports-writing-a-plugin%2F&title=Writing%20a%20report%20plugin">
		<svg class="linkedin" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19,19H16V13.7A1.5,1.5 0 0,0 14.5,12.2A1.5,1.5 0 0,0 13,13.7V19H10V10H13V11.2C13.5,10.36 14.59,9.8 15.5,9.8A3.5,3.5 0 0,1 19,13.3M6.5,8.31C5.5,8.31 4.69,7.5 4.69,6.5A1.81,1.81 0 0,1 6.5,4.69C7.5,4.69 8.31,5.5 8.31,6.5A1.81,1.81 0 0,1 6.5,8.31M8,19H5V10H8M20,2H4C2.89,2 2,2.89 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4C22,2.89 21.1,2 20,2Z" /></svg>
	
 LinkedIn</a></li>
		</ul>
	</div>
</div>

<script src="/js/main.js"></script>

<script>
	var headings = document.querySelectorAll("h2[id]");

	console.log(headings);
	for (var i = 0; i < headings.length; i++) {
		var anchorLink = document.createElement("a");
		anchorLink.innerText = "#";
		anchorLink.href = "#" + headings[i].id;
		anchorLink.classList.add("header-link");

		headings[i].appendChild(anchorLink);
	}

	$(".modalOpen").click(function() {
		var id = $(this).attr("href");
		$(id).addClass("show");

		$(window).click(function() {
			$(".show").removeClass("show");
		});

		$(id + " > div").click(function(event){
			event.stopPropagation();
		});
		return false;
	});

	$(".close").click(function() {
		$(".show").removeClass("show");
		return false;
	});

	$(document).keyup(function(e) {
		if (e.keyCode == 27) {
			$(".show").removeClass("show");
		}
	});
</script>

			</div>
		</section>

		<footer>
	<div class="wrapper">
		<p class="edit-footer"><a class="editor-link btn" href="cloudcannon:collections/_data/footer.yml" class="btn" style="padding: 5px;"><strong>&#9998;</strong> Edit footer</a></p>
		<ul class="footer-links">
			
				<li><a target="_blank" href="https://facebook.com/techjoomla" class="Facebook-icon">
					
						
		<svg class="facebook" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19,4V7H17A1,1 0 0,0 16,8V10H19V13H16V20H13V13H11V10H13V7.5C13,5.56 14.57,4 16.5,4M20,2H4A2,2 0 0,0 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4C22,2.89 21.1,2 20,2Z" /></svg>
	

					
					</a></li>
			
				<li><a target="_blank" href="https://twitter.com/techjoomla" class="Twitter-icon">
					
						
		<svg class="twitter" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	

					
					</a></li>
			
				<li><a target="_blank" href="https://youtube.com/techjoomla" class="YouTube-icon">
					
						
		<svg class="youtube" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M10,16.5V7.5L16,12M20,4.4C19.4,4.2 15.7,4 12,4C8.3,4 4.6,4.19 4,4.38C2.44,4.9 2,8.4 2,12C2,15.59 2.44,19.1 4,19.61C4.6,19.81 8.3,20 12,20C15.7,20 19.4,19.81 20,19.61C21.56,19.1 22,15.59 22,12C22,8.4 21.56,4.91 20,4.4Z" /></svg>
	

					
					</a></li>
			
				<li><a  href="/feed.xml" class="RSS-icon">
					
						
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
		

					
					</a></li>
			
		</ul>
		<p class="copyright">&copy; Techjoomla 2017. All rights reserved.</p>
	</div>
</footer>
		<script>
			$(function() {
				$('a[href*=\\#]').not(".no-smooth").on('click', function(event){
					var el = $(this.hash);
					if (el.length > 0) {
						// event.preventDefault();
						$('html,body').animate({scrollTop:$(this.hash).offset().top - 50}, 500);
					}
				});

				$('svg').click(function() {
					$(this).parent('form').submit();
				});
			});

			document.getElementById("open-nav").addEventListener("click", function (event) {
				event.preventDefault();
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
